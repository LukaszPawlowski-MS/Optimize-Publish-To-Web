<!DOCTYPE html>
<html>
<head>
	<title>Optimize Your Power BI Embed Code</title>
	<meta http-equiv="x-ua-compatible" content="IE=edge" />
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
		<div class="container">
			<div class="title">
				<h1 id="ifgt" class="page-heading">Optimize Your Power BI Embed Code</h1>
				<p>This tool ensures your Power BI publish to web report fits nicely in your web page or blog.</p>
			</div>
			<br>
			<div id="input-tables" class="form-container">
				<div class="js-input-table">
					<div class="report-header-container">
						<h4 class="report-heading">Step 1 - Power BI Report</h4>
						<p class="required">* indicates a required field</p>
					</div>
					<table>
						<tr>
							<td>Report dimensions <span class="required">*</span> <span class="info-icon" title="You may enter the page size in pixels e.g. 1280 x 720">&#128712;</span></td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="pbirw-1" class="form-input" value="16" type="number" /> x <input id="pbirh-1" class="form-input" value="9" type="number" />
								<div class="form-error-msg js-page-width-error-msg-1">Enter a page width.</div>
							</td>
						</tr>
						<tr>
							<td>Minimum report width <span class="required">*</span> <span class="info-icon" title="This setting controls the minimum width that the report will shrink to when resizing.">&#128712;</span></td>
						</tr>
						<tr id="cmw-row">
							<td class="form-cell">
								<input id="cmw-1" class="form-input" value="600" /> Pixels
								<div class="form-error-msg js-content-min-width-error-msg-1">Enter a content minimum width.</div>
							</td>
						</tr>
						<tr>
							<td class="form-cell">
								Is the report using Modern Report Headers? <span class="info-icon" title="This option is found under File -> Options -> Report Settings.&#010;If this is on this script will add 36px to the height of the page to account for the header">&#128712;</span>
								<input type="checkbox" id="header" class="form-input" checked />
							</td>
						</tr>
						<tr>
							<td>Power BI Embed Url <span class="required">*</span></td>
						</tr>
						<tr>
							<td>
								<input id="url-1" class="form-input" style="width:400px;" />
								<div class="form-error-msg js-url-error-msg-1">Enter a Power BI Embed code.</div>
							</td>
						</tr>
						<tr>
							<td colspan="2" class="form-cell">
								<button class="cta-secondary" onclick="insertExampleReport('web', 'e169');">Example 16:9 report</button> |
								<button class="cta-secondary" onclick="insertExampleReport('web', 'e43');">Example 4:3 report</button>
							</td>
						</tr>
					</table>
				</div>
				<div class="js-input-table mobile-report-form js-mobile-report-form">
					<div class="report-header-container">
						<h4 class="report-heading">Step 2 (optional) - Mobile Report <span class="info-icon" title="If you have a mobile version of your report you can enter the embed URL for that page below.&#010;Change the switching point (if needed) to match the width the of your mobile report for best results.">&#128712;</span></h4>
						<button id="expand-mobile" class="expand-button" onclick="expandButtonListener('mobile-settings', 'expand-mobile')">+</button>
					</div>
					<table id="mobile-settings" style="display: none">
						<tr>
							<td class="info">If you have a mobile version of your report you can enter the embed URL for that page below.<br>
								Change the switching point (if needed) to match the width the of your mobile report for best results.</td>
						<tr>
							<td>Mobile report dimensions</td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="pbirw-2" class="form-input" value="9" type="number" onkeyup="hanldeMobileWidthChange(this)"/> x <input id="pbirh-2" class="form-input" value="16" type="number" />
								<div class="form-error-msg js-page-width-error-msg-2">Enter a page ratio.</div>
							</td>
						</tr>
						<tr>
							<td>Page width to switch to mobile report</td>
						</tr>
						<tr id="switch-point">
							<td class="form-cell">
								<input id="sp-2" class="form-input" value="768" /> Pixels
								<div class="form-error-msg js-sp-error-msg-2">Enter a Switching Point</div>
							</td>
						</tr>
						<tr>
							<td>Mobile Power BI Embed Url</td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="url-2" class="form-input" style="width:400px;" onchange="showHideListener('mobile-image', 'url-2')"/>
								<div class="form-error-msg js-url-error-msg-2">Enter a Power BI Embed code.</div>
							</td>
						</tr>
					</table>
				</div>
				<div class="js-input-table loading-exp">
					<div class="report-header-container">
						<h4 class="report-heading">Step 3 (optional) - Loading Experience</h4>
						<button id="expand-other" class="expand-button" onclick="expandButtonListener('other-settings', 'expand-other')">+</button>
					</div>
					<table id="other-settings" style="display: none">
						<tr>
							<td class="info">
								<p>A front facing image will show as a placeholder while the report is loading.</p>
								<p>To use a front facing image you will need to upload a screenshot of the report to your CMS or other hosting environment to get a URL.</p>
								<p>Ensure this placeholder image includes the Power BI bar at the bottom and does not have any borders at the top or bottom.</p>
							</td>
						<tr>
						<tr>
							<td>Front Facing Image Url</td>
						</tr>
						<tr>
							<td>
								<input id="img-1" class="form-input" style="width:400px;"/>
							</td>
						</tr>
						<tr>
							<td colspan="2" class="form-cell">
								<button class="cta-secondary" onclick="insertExampleImage('web', 'e169');">Example 16:9 image</button> |
								<button class="cta-secondary" onclick="insertExampleImage('web', 'e43');">Example 4:3 image</button>
							</td>
						</tr>
						<tr class="hidden-field mobile-image">
							<td>Mobile Front Facing Image</td>
						</tr>
						<tr id="mobileImgRow" class="hidden-field mobile-image">
							<td class="form-cell">
								<input id="img-2" class="form-input" style="width:400px;" />
							</td>
						</tr>
						<tr>
						</tr>
						<tr class="button-customization">
							<td>When should the Power BI report start loading behind the placeholder?</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input type="radio" id="page-load" name="load-event" value="page-load" onclick="handleLoadEventChange(this);" checked />
								<label for="page-load">Immediately</label><br>
								<input type="radio" id="click" name="load-event" value="click" onclick="handleLoadEventChange(this);" />
								<label for="click">After the placeholder is clicked</label><br>
								<input type="radio" id="seconds-timeout" name="load-event" value="seconds-timeout" onclick="handleLoadEventChange(this);" />
								<label for="seconds-timeout">After some amount of time</label>
								<div id="seconds-container" style="display: none; margin-left: 90px; height: 10px;">
									<label for="seconds">Seconds: </label>
									<input type="number" id="seconds" value="5" style="width: 40px">
								</div><br>
								<input type="radio" id="in-view" name="load-event" value="in-view" onclick="handleLoadEventChange(this);" />
								<label for="in-view">Once the placeholder is scrolled into view</label>
							</td>
						</tr>
						<tr class="button-customization">
							<td>
								<h4 class="report-heading">Customize the Click to Interact button</h4>
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Position</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<label for="btn-pos-left">Left: </label>
								<input type="number" id="btn-pos-left" class="form-input" value="6" style="width:40px" />%<br>
								<label for="btn-pos-top">Top:  </label>
								<input type="number" id="btn-pos-top" class="form-input" value="70" style="width:40px" />%
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Click to Interact text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="waiting-txt" class="form-input" value="&#9654; Show interactive" style="width:400px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Loading Report text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="loading-txt" class="form-input" value="Loading..." style="width:400px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Report is Ready text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="ready-txt" class="form-input" value="&#9654; Show interactive" style="width:400px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Button Default Color</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="colorDefault" class="form-input" value="#f2c811" style="width:80px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Button Mouse Over Color</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="colorMouseOver" class="form-input" value="#333333" style="width:80px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Button Default Text Color</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="colorTextDefault" class="form-input" value="#333333" style="width:80px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Button Mouse Over Text Color</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="colorTextMouseOver" class="form-input" value="#FFFFFF" style="width:80px;" />
							</td>
						</tr>


					</table>
				</div>
			</div>
			<br><br>
			<div class="form-cta-wrapper">
				<button id="gec" class="form-cta" onclick="generateEmbedCode()">Create my code!</button>
			</div>
		</div>

		<textarea id="tFrame" style="display: none; height:300px; width:600px;">
<script type="text/javascript">
!function(){if("undefined"==typeof window.powerbiresizescript){window.powerbiresizescript=1;window.onmessage=function(event){var isReportPageLoadedEvent=function(event){try{if(event&&event.data&&event.data.url==='/reports/undefined/events/pageChanged'){return!0}}catch(error){return undefined}};if(isReportPageLoadedEvent(event)){var iframe=getIframeElement(event.source)
setTimeout(function(){if(iframe&&iframe.parentNode.children.length>1){switch(iframe.parentNode.getAttribute('pbi-resize-load-event')){case 'click':showElement(iframe);break;case 'page-load':case 'seconds-timeout':case 'in-view':var button=getChildByTag(iframe.parentNode,'div');setButtonState(button,'readynow');break}}},(iframe.parentNode.getAttribute('pbi-resize-delay-show')||1)*1000)}};function getChildByTag(parent,tagName){if(parent){for(var i=0;i<parent.children.length;i++){if(parent.children[i].tagName.toLowerCase()===tagName.toLowerCase()){return parent.children[i]}}}
return null}
function getIframeElement(srcWindow){var frames=document.getElementsByTagName('iframe');for(var i=0;i<frames.length;i++){if(frames[i].contentWindow===srcWindow){return frames[i]}}}
function showElement(iframe){if(!iframe){return}
var parent=iframe.parentNode;var button=getChildByTag(parent,'div');if(button){parent.removeChild(button)}
var spinner=getChildByTag(parent,'span');if(spinner){parent.removeChild(spinner)}
iframe.style.position='static';iframe.style.visibility='visible';var img=getChildByTag(parent,'img');if(img){parent.removeChild(img)}}
function setButtonState(button,state){button.setAttribute('data-state',state);var states=[{state:'waiting',text:button.getAttribute('pbi-resize-wait-txt')},{state:'loading',text:button.getAttribute('pbi-resize-load-txt')},{state:'loadingnow',text:button.getAttribute('pbi-resize-load-txt')},{state:'ready',text:button.getAttribute('pbi-resize-rdy-txt')},{state:'readynow',text:button.getAttribute('pbi-resize-load-txt')}]
var text='';for(var i=0;i<states.length;i++){if(states[i].state===state){text=states[i].text}}
var spinner=getChildByTag(button,'span');button.innerHTML=text+spinner.outerHTML;switch(state){case 'loading':button.onclick=function(){setButtonState(button,'loadingnow')}
button.parentNode.onclick=function(){setButtonState(button,'loadingnow')}
break;case 'readynow':resize();var iframe=getChildByTag(button.parentNode,'iframe');showElement(iframe)
break;case 'ready':resize();var spinner=getChildByTag(button,'span');spinner.style.display='none';button.style.width='auto';button.onclick=function(e){var iframe=getChildByTag(e.target.parentNode,'iframe');showElement(iframe)}
button.parentNode.onclick=function(e){var iframe=getChildByTag(e.target.parentNode,'iframe');showElement(iframe)}
break}}
var e=function(){for(var e=document.querySelectorAll('[pbi-resize="powerbi"]'),i=0;i<e.length;i++){e[i].style.width='100%';var actualWidth=e[i].clientWidth;var contentMinWidth=e[i].getAttribute("pbi-resize-min-width");var height=e[i].getAttribute('height');var webImg=e[i].getAttribute('pbi-resize-img');var mobileImg=e[i].getAttribute('pbi-resize-m-img')||webImg;var webWidth=e[i].getAttribute("pbi-resize-width");var webHeight=e[i].getAttribute("pbi-resize-height");var webSrc=e[i].getAttribute("pbi-resize-src");var mobileWidth=e[i].getAttribute("pbi-resize-m-width");var mobileHeight=e[i].getAttribute("pbi-resize-m-height");var mobileSrc=e[i].getAttribute("pbi-resize-m-src");var loadEvent=e[i].getAttribute('pbi-resize-load-event');var header=e[i].getAttribute('pbi-resize-header');var img=getChildByTag(e[i],'img');var iframe=getChildByTag(e[i],'iframe');var currentSrc=iframe?iframe.getAttribute('src'):null;var mobileRatio=mobileWidth/mobileHeight;var webRatio=webWidth/webHeight;var isWebSize=actualWidth>contentMinWidth;var newSrc=!(webSrc&&mobileSrc)?webSrc:(isWebSize?webSrc:mobileSrc);var resizedToWeb=((iframe&&iframe.src==mobileSrc)||(img&&img.src==mobileImg))&&isWebSize&&mobileSrc!=webSrc;var resizedToMobile=((iframe&&iframe.src==webSrc)||(img&&img.src==webImg))&&!isWebSize&&mobileSrc!=webSrc;var currentSrcIsImage=e[i].children.length>1?!0:!1;if(!currentSrc){if(iframe){iframe.style.position='absolute';iframe.style.top=0;iframe.style.left=0;iframe.style.visibility='hidden'}
if(img){img.setAttribute('src',(!isWebSize&&mobileImg)?mobileImg:webImg)}
if((!webImg&&webSrc&&isWebSize)||(!mobileImg&&mobileSrc&&!isWebSize)){iframe.setAttribute('src',(!isWebSize&&mobileSrc)?mobileSrc:webSrc);showElement(iframe);resize();break}else if((webImg&&webSrc)||(mobileImg&&mobileSrc)){var button=getChildByTag(e[i],'div');setButtonState(button,'waiting');switch(loadEvent){case 'page-load':loadIframe(iframe.parentNode,newSrc);break;case 'seconds-timeout':var timeout=parseInt(e[i].getAttribute('pbi-resize-seconds'))*1000;t=setTimeout(function(){loadIframe(iframe.parentNode,newSrc)},timeout);break;case 'in-view':if(currentSrcIsImage&&!iframe.src&&isInViewport(img)){loadIframe(iframe.parentNode,newSrc)}
window.addEventListener('scroll',function(){if(currentSrcIsImage&&!iframe.src&&isInViewport(img)){loadIframe(iframe.parentNode,newSrc)}},!1);break;case 'click':button.onclick=function(){loadIframe(iframe.parentNode,newSrc)}
e[i].firstChild.onclick=function(){loadIframe(iframe.parentNode,newSrc)}
break}}}
if((currentSrc==webImg&&!webImg&&webSrc&&isWebSize)||(currentSrc==mobileImg&&!mobileImg&&mobileSrc&&!isWebSize)){showElement(iframe)}
else if(resizedToMobile||resizedToWeb){changeCurrentSrc(e[i].children[0],isWebSize,currentSrcIsImage?webImg:webSrc,currentSrcIsImage?mobileImg:mobileSrc,newSrc)}
if(currentSrcIsImage&&((resizedToMobile&&!mobileImg&&mobileSrc)||(resizedToWeb&&!webImg&&webSrc))){showElement(iframe)}
else if(!currentSrcIsImage&&((resizedToMobile&&mobileImg&&!mobileSrc)||(resizedToWeb&&webImg&&!webSrc))){showElement(iframe)}
if(img&&img.parentNode){resizeElement(img,header,actualWidth,isWebSize,webRatio,mobileRatio,webHeight,mobileHeight)}
if(iframe){resizeElement(iframe,header,actualWidth,isWebSize,webRatio,mobileRatio,webHeight,mobileHeight)}}};function resizeElement(element,header,actualWidth,isWebSize,webRatio,mobileRatio,webHeight,mobileHeight){var warn=!1;if(mobileRatio&&mobileHeight){var pageSize=isWebSize?webRatio:mobileRatio;var pageHeight=isWebSize?webHeight:mobileHeight}
else{var pageSize=webRatio;var pageHeight=webHeight}
var p169=16.0/9.0;var p43=4.0/3.0;var heightOffset=header.toLowerCase()=="true"?36:56;if(actualWidth<569&&pageSize===p169){element.parentNode.style.width="568.88px";element.style.width="568.88px";element.style.height=320+heightOffset+"px";warn=!0}
else if(actualWidth<=437&&pageSize===p43){element.parentNode.style.width="426.66px";element.style.width="426.66px";element.style.height=320+heightOffset+"px";warn=!0}
else if(actualWidth<320||actualWidth/pageSize<320||(pageHeight<320&&pageSize!==p169&&pageSize!==p43)){var height=Math.max(actualWidth,320)/pageSize;if(height<320){element.parentNode.style.width=320*pageSize+"px";element.style.width=320*pageSize+"px";element.style.height=320+heightOffset+"px"}
else if(actualWidth<320){element.parentNode.style.width=320+"px";element.style.width=320+"px";element.style.height=height+heightOffset+"px"}
else{element.parentNode.style.width=actualWidth+"px";element.style.width=actualWidth+"px";element.style.height=height+heightOffset+"px"}
warn=!0}
else{element.parentNode.style.width="100%";element.style.width="100%";element.style.height=Math.max(element.clientWidth/pageSize,320)+heightOffset+"px"}
if(warn){console.warn("pbi-resize: requested iframe dimension is below the minimum supported dimensions. Minimum supported width is 320px. Minimum supported height is 376px. Change your Power BI report page size to ensure your content looks great when embedded in your web page or blog.")}}
document.addEventListener("DOMContentLoaded",e);window.addEventListener("resize",e);window.addEventListener("orientationchange",e);function isInViewport(e){var bounding=e.getBoundingClientRect();return(bounding.top>=0&&bounding.left>=0&&bounding.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&bounding.right<=(window.innerWidth||document.documentElement.clientWidth))};function changeCurrentSrc(e,isWebSize,web,mobile,newSrc){if(web&&mobile){var iframe=e.nextElementSibling;if(e instanceof HTMLImageElement&&iframe.src&&(newSrc!=iframe.src)){iframe.setAttribute('src',newSrc);setButtonState(iframe.nextElementSibling,'loading')}
var currentSrc=isWebSize?web:mobile;e.setAttribute('src',currentSrc)}}
function resize(){if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){var evt=document.createEvent('UIEvents');evt.initUIEvent('resize',!0,!1,window,0);window.dispatchEvent(evt)}else{window.dispatchEvent(new Event('resize'))}}
function loadIframe(parent,src){var iframe=getChildByTag(parent,'iframe');var button=getChildByTag(parent,'div');var spinner=getChildByTag(button,'span');spinner.style.display='block';var style=document.createElement('style');style.type='text/css';var keyFrames='@keyframes pbi-resize-spinner {\
                0% {\
                    transform: rotate(0deg);\
                }\
                100% {\
                    transform: rotate(360deg);\
                }\
            }';style.innerHTML=keyFrames;document.getElementsByTagName('head')[0].appendChild(style);iframe.setAttribute('src',src);iframe.setAttribute('frameborder','0');iframe.setAttribute('allowFullScreen','true');setButtonState(button,'loading')}}}();
</script>
</textarea>
		<div id="outputContainer" style="display: none; width:70%; margin: auto;">
			<br>
			<h4 class="result-heading">Your Optimized Embed Code</h4>
			<p style="text-align: left;">(copy and paste it into your web page)</p>
			<textarea id="oFrame" style="display: inline-block; height:220px; width: 100%;" onclick="this.select()"></textarea>
			<br>
			<br>
			<br>
			<div class="form-cta-wrapper">
				<button class="form-cta" onclick="showResult();">Show me how it looks</button>
				<br>
				<br>
			</div>
			<br>
			<div id="result"></div>
		</div>
		<br>
		<br>
		<br>
		<br>

		<script type="text/javascript">
			var reportCount = 1;

			function addTextInputListener(inputId, errorMsgIdentifier) {
				document.getElementById(inputId).addEventListener("focus", function () {
					var errorMsg = document.getElementsByClassName(errorMsgIdentifier)[0];
					if(errorMsg && errorMsg.classList.contains("visible")) {
						errorMsg.classList.remove("visible");
					}
				});
			};

			// Desktop input listeners
			addTextInputListener('pbirw-1', 'js-page-width-error-msg-1');
			addTextInputListener('pbirh-1', 'js-page-height-error-msg-1');
			addTextInputListener('cmw-1', 'js-content-min-width-error-msg-1');
			addTextInputListener('img-1', 'js-url-error-msg-1');
			addTextInputListener('url-1', 'js-url-error-msg-1');

			// Mobile input listeners
			addTextInputListener('pbirw-2', 'js-page-width-error-msg-2');
			addTextInputListener('pbirh-2', 'js-page-height-error-msg-2');
			addTextInputListener('sp-2', 'js-sp-error-msg-2');
			addTextInputListener('img-2', 'js-url-error-msg-2');
			addTextInputListener('url-2', 'js-url-error-msg-2');

			function showHideListener(inputClass, dependentId) {
				var elements = document.getElementsByClassName(inputClass);
				var dependentElement = document.getElementById(dependentId);
				for(let i = 0; i < elements.length; i++) {
					if(dependentElement.value) {
						elements[i].style.display = 'table-row';
					}
					else {
						elements[i].style.display = 'none';
					}
				}
			}

			function expandButtonListener(tableId, buttonId) {
				var table = document.getElementById(tableId);
				var button = document.getElementById(buttonId);
				if(table.classList.contains('visible')) {
					table.style.display = 'none';
					table.classList.remove('visible');
					button.innerHTML = '+';
				}
				else {
					table.style.display = 'table';
					table.classList.add('visible');
					button.innerHTML = '-';
				}
			}

			function hanldeMobileWidthChange(e) {
				var switchPoint = document.getElementById('sp-2');
				switchPoint.value = e.value;
			}

			function validateTextField(input, fieldIdentifier, errors) {
				var errorMsg = document.getElementsByClassName(fieldIdentifier)[0];
				if (input === "") {
					errorMsg.classList.add("visible");
					errors = true;
				} else {
					//errorMsg.classList.remove("visible");
				}
				return errors;
			}

			function clearResultSections() {
				var oFrameElement = document.getElementById("oFrame");
				oFrameElement.value = "";

				var result = document.getElementById("result");
				result.innerHTML = "";

				var outputContainerElement = document.getElementById("outputContainer");
				outputContainerElement.style.display = 'none';
			}

			function generateEmbedCode() {
				var errors = false;
				var outputContainerElement = document.getElementById("outputContainer");
				var oFrameElement = document.getElementById("oFrame");
				var template = document.getElementById("tFrame").value;

				clearResultSections();

				//Get inputs
				var webWidth = document.getElementById('pbirw-1').value;
				var webHeight = document.getElementById('pbirh-1').value;
				var webImg = document.getElementById('img-1').value;
				var webSrc = document.getElementById('url-1').value;
				var cmw = document.getElementById('cmw-1').value;
				var cmh = cmw * webWidth / webHeight + 56;
				var loadEvent = document.querySelector('input[name="load-event"]:checked').value;
				var header = document.getElementById('header').checked;
				var btnLeftPos = document.getElementById('btn-pos-left').value;
				var btnTopPos = document.getElementById('btn-pos-top').value;
				var waitingText = document.getElementById('waiting-txt').value;
				var loadingText = document.getElementById('loading-txt').value;
				var readyText = document.getElementById('ready-txt').value;
				var colorDefaultHex= document.getElementById('colorDefault').value;
				var colorMouseOverHex = document.getElementById('colorMouseOver').value;
				var colorTextDefaultHex = document.getElementById('colorTextDefault').value;
				var colorTextMouseOverHex = document.getElementById('colorTextMouseOver').value;

				var mobileImg = document.getElementById('img-2').value;

				// Do form validation
				errors = validateTextField(webWidth, 'js-page-width-error-msg-1', errors);
				errors = validateTextField(webHeight, 'js-page-height-error-msg-1', errors);
				if(!webImg && !webSrc) {
					errors = validateTextField(webSrc, 'js-url-error-msg-1', errors);
				}

				var mobileSrc = document.getElementById('url-2').value;
				var mobileWidth = document.getElementById('pbirw-2').value;
				var mobileHeight = document.getElementById('pbirh-2').value;
				var switchPoint = document.getElementById('sp-2').value;
				var cmh = switchPoint * mobileWidth / mobileHeight + 56;
				var img = window.innerWidth < switchPoint && mobileImg ? mobileImg : webImg;
				var url = window.innerWidth < switchPoint && mobileSrc ? mobileSrc : webSrc;

				//Do form validation for mobile
				if(document.getElementById('mobile-settings').classList.contains('visible')) {
					errors = validateTextField(switchPoint, 'js-sp-error-msg-2', errors);
				}
				errors = validateTextField(cmw, 'js-content-min-width-error-msg-1', errors);

				//replace placeholders with input variables for output
				if (!errors) {

					var container = document.createElement('div');
					container.setAttribute('pbi-resize', 'powerbi');
					if (webImg) {
						container.setAttribute('pbi-resize-img', webImg);
						var img = document.createElement('img');
					}
					if (webSrc) {
						container.setAttribute('pbi-resize-src', webSrc);
						var iframe = document.createElement('iframe');
					}
					container.setAttribute('pbi-resize-min-width', cmw);
					container.setAttribute('pbi-default-width', '600px');
					container.setAttribute('pbi-default-height', cmh);
					container.setAttribute('pbi-resize-width', webWidth);
					container.setAttribute('pbi-resize-height', webHeight);
					container.setAttribute('pbi-resize-src', webSrc);
					container.setAttribute('pbi-resize-load-event', loadEvent);
					if(loadEvent == "seconds-timeout") {
						container.setAttribute('pbi-resize-seconds', document.getElementById('seconds').value);
					}
					container.setAttribute('pbi-resize-header', header);
					container.style.position = 'relative';

					if(mobileImg || mobileSrc) {
						if(mobileImg) {
							container.setAttribute('pbi-resize-m-img', mobileImg);
							if(!img) {
								var img = document.createElement('img');
							}
						}
						if(mobileSrc) {
							container.setAttribute('pbi-resize-m-src', mobileSrc);
						}
						container.setAttribute('pbi-resize-m-width', mobileWidth);
						container.setAttribute('pbi-resize-m-height', mobileHeight);
						container.setAttribute('pbi-resize-min-width', switchPoint);
					}

					if (img) {
						container.appendChild(img);
					}
					if (iframe) {
						iframe.setAttribute('frameborder', 0);
						iframe.setAttribute('allowFullScreen', true);
						container.appendChild(iframe);
					}
					if(img && iframe) {
						var button = document.createElement('div');
						img.style.cursor = 'pointer';
						button.style.display = 'flex';
						button.style.justifyContent = 'space-between';
						button.style.lineHeight = '32px';
						button.style.backgroundColor = colorDefaultHex;
						button.style.position = 'absolute';
						button.style.left = btnLeftPos + '%';
						button.style.top = btnTopPos + '%';
						button.style.marginLeft = 'auto';
						button.style.marginRight = 'auto';
						button.style.color = colorTextDefaultHex;
						button.style.padding = '10px';
						button.style.cursor = 'pointer';
						//button.style.border = 'rgb(50, 50, 50, 1) 2px solid';
						button.style.fontFamily = 'Arial, Helvetica, sans-serif';
						button.style.fontSize = '1.8em';
						button.style.minWidth = '180px';
						button.style.borderRadius = '2px';
						button.style.transition = 'all .1s ease-in-out';
						button.setAttribute('pbi-resize-wait-txt', waitingText);
						button.setAttribute('pbi-resize-load-txt', loadingText);
						button.setAttribute('pbi-resize-rdy-txt', readyText);


						var spinner = document.createElement('span');
						spinner.classList.add('pbi-resize-spinner');
						spinner.style.display = 'none';
						spinner.style.width = '25px';
						spinner.style.height = '25px';
						spinner.style.margin = '1px';
						spinner.style.marginLeft = '8px';
						spinner.style.borderRadius = '50%';
						//spinner.style.border = '2px solid #000';
						spinner.style.border = '2px solid ' + colorTextDefaultHex;
						//spinner.style.borderColor = '#000 transparent #000 transparent';


						spinner.style.borderColor = borderColorDefault 
						spinner.style.animation = 'pbi-resize-spinner 1.2s linear infinite';

						// add interactivity Prep
						var actionSpinnerOnMouseOver = "style.borderColor = '" + borderColorMouseOver + "';";
						var actionSpinnerOnOut = "style.borderColor = '" + borderColorDefault + "';";
						var borderColorDefault =  colorTextDefaultHex + " transparent " + colorTextDefaultHex + " transparent";
						var borderColorMouseOver =  colorTextMouseOverHex + " transparent " + colorTextMouseOverHex + " transparent";

						// set actions
						button.setAttribute('onmouseover', "style.backgroundColor = '" 
										   + colorMouseOverHex 
										   + "'; style.color = '" 
									           + colorTextMouseOverHex 
										   + "'; (this.getElementsByClassName('pbi-resize-spinner')[0]).style.borderColor = '" 
										   + borderColorMouseOver + "';");

						button.setAttribute('onmouseout', "style.backgroundColor = '" 
										  + colorDefaultHex 
										  + "'; style.color = '" 
										  + colorTextDefaultHex 
										  + "'; (this.getElementsByClassName('pbi-resize-spinner')[0]).style.borderColor = '" 
										  + borderColorDefault + "';");

						spinner.setAttribute('onmouseover', actionSpinnerOnMouseOver );
						spinner.setAttribute('onmouseout', actionSpinnerOnOut );


						button.appendChild(spinner);
						container.appendChild(button);
					}

					var output = container.outerHTML;
					oFrameElement.value = output += template;
					outputContainerElement.style.display = '';
				}
			};

			function removeExcessForms(formsRemaining) {
                var form = document.getElementsByClassName("js-mobile-report-form")[0];
                if (form.classList.contains("visible")) {
                    var mobileReportToggle = document.getElementById("mobile-report-toggle");
                    mobileReportToggle.innerText = 'Remove Mobile Report';
                    reportCount--;
                }
			}

			function insertExampleReport(size, example) {
				var sn = "https://app.powerbi.com/view?r=eyJrIjoiZDZlYmM1ZTQtYTBkZi00OGYzLThiNmUtMDU5Nzc0NDVjNTIyIiwidCI6IjNkODE4OGM4LTc3NTgtNDYzYy1iYjNmLTBlMTYwZGUzMzYwZiIsImMiOjN9";
				var ft = "https://app.powerbi.com/view?r=eyJrIjoiZTM1MTU1ZTEtNGU0MC00MWYwLWE2NjUtYTIyODVjMmJjMDdkIiwidCI6Ijk0MjYwZjAzLTA3OTMtNDg0YS05MWNmLWJlYmU1ODQzMTliYyIsImMiOjEwfQ%3D%3D";
				var msn = "https://app.powerbi.com/view?r=eyJrIjoiZmUxMjlmNmYtYjY4NC00YWE1LTkyZmMtMmI2ZjVjZGI1NTYyIiwidCI6Ijk0MjYwZjAzLTA3OTMtNDg0YS05MWNmLWJlYmU1ODQzMTliYyIsImMiOjEwfQ%3D%3D";
				var mft = "https://app.powerbi.com/view?r=eyJrIjoiODc4ZjNjNzItZDE5ZC00NTkxLWEwNTEtNzc5OTI3ZTA4NWUxIiwidCI6IjcyZjk4OGJmLTg2ZjEtNDFhZi05MWFiLTJkN2NkMDExZGI0NyIsImMiOjV9";

				removeExcessForms(1);

				if(size == 'web') {
					switch (example) {
					case "e169":
						writeExample('url-1', size, "600", "16:9", 16, 9, sn, false);
						break;
					case "e43":
						writeExample('url-1', size, "600", "4:3", 4, 3, ft, false);
						break;
					}
				}
				else {
					switch (example) {
					case "e169":
						writeExample('url-2', size, null, "9:16", 9, 16, msn);
						break;
					case "e43":
						writeExample('url-2', size, null, "3:4", 3, 4, mft);
						break;
					}
				}
			}

			function insertExampleImage(size, example) {
				var sn = window.location + "16x9.png";
				var ft = window.location + "4x3.png";
				var ns = window.location + "9x16.png";
				var tf = window.location + "3x4.png";

				removeExcessForms(1);

				if(size == 'web') {
					let elements = document.getElementsByClassName('button-customization');
					for(let i = 0; i < elements.length; i++) {
						elements[i].style.display = 'table-row';
					}
					switch (example) {
					case "e169":
						writeExample('img-1', size, "600", "16:9", 16, 9, sn);
						break;
					case "e43":
						writeExample('img-1', size, "600", "4:3", 4, 3, ft);
						break;
					}
				}
				else {
					switch (example) {
					case "e169":
						writeExample('img-2', size, null, "16:9", 9, 16, ns);
						break;
					case "e43":
						writeExample('img-2', size, null, "4:3", 3, 4, tf);
						break;
					}
				}
			}

			function writeExample(id, size, contentMinimumWidth, pageSizeRatio, pageWidth, pageHeight, url, modernheaders) {
				document.getElementById("outputContainer").style.display = 'none';

				var editState = true;
				if (pageSizeRatio === "Custom") {
					editState = false;
				}

				document.getElementById("header").checked = modernheaders;

				if(size == 'web'){
					var pbirw = document.getElementById("pbirw-1");
					pbirw.value = pageWidth;

					var pbirh = document.getElementById("pbirh-1");
					pbirh.value = pageHeight;

					document.getElementById("cmw-1").value = contentMinimumWidth;
					document.getElementById(id).value = url;
				}
				else {
					var pbirw = document.getElementById("pbirw-2");
					pbirw.value = pageWidth;

					var pbirh = document.getElementById("pbirh-2");
					pbirh.value = pageHeight;

					document.getElementById(id).value = url;
				}

				document.getElementById("oFrame").value = "";
			}

			function showResult() {
				document.getElementById("result").innerHTML = document.getElementById("oFrame").value;

				// raise the page resize event so our script runs
				if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {
					// work around for IE
					var evt = document.createEvent('UIEvents');
					evt.initUIEvent('resize', true, false, window, 0);
					window.dispatchEvent(evt);
				} else {
					// other browsers
					window.dispatchEvent(new Event('resize'));
				}
			}

		</script>
		<script>
			function handleLoadEventChange(e) {
				var secs = document.getElementById('seconds-container');
				if(e.value == 'seconds-timeout'){
					secs.classList.add('visible');
					secs.style.display = 'inline-block';
				}
				else {
					secs.classList.remove('visible');
					secs.style.display = 'none';
				}
			}
		</script>
		<script src="script.js"></script>
</body>
</html>
