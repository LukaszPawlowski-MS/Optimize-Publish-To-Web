<!DOCTYPE html>
<html>
<head>
	<title>Optimize Your Power BI Embed Code</title>
	<meta http-equiv="x-ua-compatible" content="IE=edge" />
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
		<div class="container">
			<div class="title">
				<h1 id="ifgt" class="page-heading">Optimize Your Power BI Embed Code</h1>
				<p>This tool ensures your Power BI publish to web report fits nicely in your web page or blog.</p>
			</div>
			<br>
			<div id="input-tables" class="form-container">
				<div class="js-input-table">
					<div class="report-header-container">
						<h4 class="report-heading">Step 1 - Power BI Report</h4>
						<p class="required">* indicates a required field</p>
					</div>
					<table>
						<tr>
							<td>Report dimensions <span class="required">*</span> <span class="info-icon" title="You may enter the page size in pixels e.g. 1280 x 720">&#128712;</span></td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="pbirw-1" class="form-input" value="16" type="number" /> x <input id="pbirh-1" class="form-input" value="9" type="number" />
								<div class="form-error-msg js-page-width-error-msg-1">Enter a page width.</div>
							</td>
						</tr>
						<tr>
							<td>Minimum report width <span class="required">*</span> <span class="info-icon" title="This setting controls the minimum width that the report will shrink to when resizing.">&#128712;</span></td>
						</tr>
						<tr id="cmw-row">
							<td class="form-cell">
								<input id="cmw-1" class="form-input" value="600" /> Pixels
								<div class="form-error-msg js-content-min-width-error-msg-1">Enter a content minimum width.</div>
							</td>
						</tr>
						<tr>
							<td class="form-cell">
								Is the report using Modern Report Headers? <span class="info-icon" title="This option is found under File -> Options -> Report Settings.&#010;If this is on this script will add 36px to the height of the page to account for the header">&#128712;</span>
								<input type="checkbox" id="header" class="form-input" checked />
							</td>
						</tr>
						<tr>
							<td>Power BI Embed Url <span class="required">*</span></td>
						</tr>
						<tr>
							<td>
								<input id="url-1" class="form-input" style="width:400px;" />
								<div class="form-error-msg js-url-error-msg-1">Enter a Power BI Embed code.</div>
							</td>
						</tr>
						<tr>
							<td colspan="2" class="form-cell">
								<button class="cta-secondary" onclick="insertExampleReport('web', 'e169');">Example 16:9 report</button> |
								<button class="cta-secondary" onclick="insertExampleReport('web', 'e43');">Example 4:3 report</button>
							</td>
						</tr>
					</table>
				</div>
				<div class="js-input-table mobile-report-form js-mobile-report-form">
					<div class="report-header-container">
						<h4 class="report-heading">Step 2 (optional) - Mobile Report <span class="info-icon" title="If you have a mobile version of your report you can enter the embed URL for that page below.&#010;Change the switching point (if needed) to match the width the of your mobile report for best results.">&#128712;</span></h4>
						<button id="expand-mobile" class="expand-button" onclick="expandButtonListener('mobile-settings', 'expand-mobile')">+</button>
					</div>
					<table id="mobile-settings" style="display: none">
						<tr>
							<td class="info">If you have a mobile version of your report you can enter the embed URL for that page below.<br>
								Change the switching point (if needed) to match the width the of your mobile report for best results.</td>
						<tr>
							<td>Mobile report dimensions</td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="pbirw-2" class="form-input" value="9" type="number" onkeyup="hanldeMobileWidthChange(this)"/> x <input id="pbirh-2" class="form-input" value="16" type="number" />
								<div class="form-error-msg js-page-width-error-msg-2">Enter a page ratio.</div>
							</td>
						</tr>
						<tr>
							<td>Page width to switch to mobile report</td>
						</tr>
						<tr id="switch-point">
							<td class="form-cell">
								<input id="sp-2" class="form-input" value="768" /> Pixels
								<div class="form-error-msg js-sp-error-msg-2">Enter a Switching Point</div>
							</td>
						</tr>
						<tr>
							<td>Mobile Power BI Embed Url</td>
						</tr>
						<tr>
							<td class="form-cell">
								<input id="url-2" class="form-input" style="width:400px;" onchange="showHideListener('mobile-image', 'url-2')"/>
								<div class="form-error-msg js-url-error-msg-2">Enter a Power BI Embed code.</div>
							</td>
						</tr>
					</table>
				</div>
				<div class="js-input-table loading-exp">
					<div class="report-header-container">
						<h4 class="report-heading">Step 3 (optional) - Loading Experience</h4>
						<button id="expand-other" class="expand-button" onclick="expandButtonListener('other-settings', 'expand-other')">+</button>
					</div>
					<table id="other-settings" style="display: none">
						<tr>
							<td class="info">
								<p>A front facing image will show as a placeholder while the report is loading.</p>
								<p>To use a front facing image you will need to upload a screenshot of the report to your CMS or other hosting environment to get a URL.</p>
								<p>To create this screenshot in Chrome: right click anywhere in the page and choose inspect -> at the top left of the developer console, click 'Toggle Device Toolbar',
								then resize the page to the correct width and height, adding 23px to the height to allow for the Power BI bar.</p>
							</td>
						<tr>
						<tr>
							<td>Front Facing Image Url</td>
						</tr>
						<tr>
							<td>
								<input id="img-1" class="form-input" style="width:400px;"/>
							</td>
						</tr>
						<tr>
							<td colspan="2" class="form-cell">
								<button class="cta-secondary" onclick="insertExampleImage('web', 'e169');">Example 16:9 image</button> |
								<button class="cta-secondary" onclick="insertExampleImage('web', 'e43');">Example 4:3 image</button>
							</td>
						</tr>
						<tr class="hidden-field mobile-image">
							<td>Mobile Front Facing Image</td>
						</tr>
						<tr id="mobileImgRow" class="hidden-field mobile-image">
							<td class="form-cell">
								<input id="img-2" class="form-input" style="width:400px;" />
							</td>
						</tr>
						<tr>
						</tr>
						<tr class="button-customization">
							<td>When should the Power BI report start loading behind the placeholder?</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input type="radio" id="page-load" name="load-event" value="page-load" onclick="handleLoadEventChange(this);" checked />
								<label for="page-load">Immediately</label><br>
								<input type="radio" id="click" name="load-event" value="click" onclick="handleLoadEventChange(this);" />
								<label for="click">After the placeholder is clicked</label><br>
								<input type="radio" id="seconds-timeout" name="load-event" value="seconds-timeout" onclick="handleLoadEventChange(this);" />
								<label for="seconds-timeout">After some amount of time</label>
								<div id="seconds-container" style="display: none; margin-left: 90px; height: 10px;">
									<label for="seconds">Seconds: </label>
									<input type="number" id="seconds" value="5" style="width: 40px">
								</div><br>
								<input type="radio" id="in-view" name="load-event" value="in-view" onclick="handleLoadEventChange(this);" />
								<label for="in-view">Once the placeholder is scrolled into view</label>
							</td>
						</tr>
						<tr class="button-customization">
							<td>
								<h4 class="report-heading">Customize the Click to Interact button</h4>
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Position</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<label for="btn-pos-left">Left: </label>
								<input type="number" id="btn-pos-left" class="form-input" value="10" style="width:40px" />%<br>
								<label for="btn-pos-top">Top:  </label>
								<input type="number" id="btn-pos-top" class="form-input" value="5" style="width:40px" />%
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Click to Interact text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="waiting-txt" class="form-input" value="Click to Interact!" style="width:400px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Loading Report text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="loading-txt" class="form-input" value="Preparing Report..." style="width:400px;" />
							</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell-label">Report is Ready text</td>
						</tr>
						<tr class="button-customization">
							<td class="form-cell">
								<input id="ready-txt" class="form-input" value="Click to Interact!" style="width:400px;" />
							</td>
						</tr>
					</table>
				</div>
			</div>
			<br><br>
			<div class="form-cta-wrapper">
				<button id="gec" class="form-cta" onclick="generateEmbedCode()">Create my code!</button>
			</div>
		</div>

		<textarea id="tFrame" style="display: none; height:300px; width:600px;">
<script>!function(){if(void 0===window.powerbiresizescript){function L(e,t){if(e)for(var i=0;i<e.children.length;i++)if(e.children[i].tagName.toLowerCase()===t.toLowerCase())return e.children[i];return null}function C(e){if(e){var t=e.parentNode,i=L(t,"div");i&&t.removeChild(i);var r=L(t,"span");r&&t.removeChild(r),e.style.position="static",e.style.visibility="visible";var n=L(t,"img");n&&t.removeChild(n),S()}}function M(e,t){e.setAttribute("data-state",t);for(var i=[{state:"waiting",text:e.getAttribute("pbi-resize-wait-txt")},{state:"loading",text:e.getAttribute("pbi-resize-load-txt")},{state:"loadingnow",text:e.getAttribute("pbi-resize-load-txt")},{state:"ready",text:e.getAttribute("pbi-resize-rdy-txt")},{state:"readynow",text:e.getAttribute("pbi-resize-load-txt")}],r="",n=0;n<i.length;n++)i[n].state===t&&(r=i[n].text);var a=L(e,"span");switch(e.innerHTML=r+a.outerHTML,t){case"loading":e.onclick=function(){M(e,"loadingnow")},e.parentNode.onclick=function(){M(e,"loadingnow")};break;case"readynow":S(),C(L(e.parentNode,"iframe"));break;case"ready":S(),(a=L(e,"span")).style.display="none",e.style.width="auto",e.onclick=function(e){C(L(e.target.parentNode,"iframe"))},e.parentNode.onclick=function(e){C(L(e.target.parentNode,"iframe"))}}}window.powerbiresizescript=1,window.onmessage=function(e){if(function(e){try{if("reportPageLoaded"==JSON.parse(e.data).event)return!0}catch(e){return}}(e)){var t=function(e){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++)if(t[i].contentWindow===e)return t[i]}(e.source);setTimeout(function(){if(t&&1<t.parentNode.children.length)switch(t.parentNode.getAttribute("pbi-resize-load-event")){case"click":C(t);break;case"page-load":case"seconds-timeout":case"in-view":var e=L(t.parentNode,"div");"loadingnow"===e.getAttribute("data-state")?M(e,"readynow"):M(e,"ready")}},1e3*(t.parentNode.getAttribute("pbi-resize-delay-show")||1))}};var e=function(){for(var e=document.querySelectorAll('[pbi-resize="powerbi"]'),i=0;i<e.length;i++){e[i].style.width="100%";var r=e[i].clientWidth,n=e[i].getAttribute("pbi-resize-min-width"),a=(e[i].getAttribute("height"),e[i].getAttribute("pbi-resize-img")),o=e[i].getAttribute("pbi-resize-m-img"),s=e[i].getAttribute("pbi-resize-width"),d=e[i].getAttribute("pbi-resize-height"),l=e[i].getAttribute("pbi-resize-src"),c=e[i].getAttribute("pbi-resize-m-width"),p=e[i].getAttribute("pbi-resize-m-height"),u=e[i].getAttribute("pbi-resize-m-src"),g=e[i].getAttribute("pbi-resize-load-event"),h=e[i].getAttribute("pbi-resize-header"),b=L(e[i],"img"),w=L(e[i],"iframe"),m=w?w.getAttribute("src"):null,f=c/p,v=s/d,y=n<r,x=l&&u?y?l:u:l,A=(w&&w.src==u||b&&b.src==o)&&y,z=(w&&w.src==l||b&&b.src==a)&&!y,N=1<e[i].children.length;if(!m){if(w&&(w.style.position="absolute",w.style.top=0,w.style.left=0,w.style.visibility="hidden"),b&&b.setAttribute("src",!y&&o?o:a),!a&&l&&y||!o&&u&&!y){w.setAttribute("src",!y&&u?u:l),C(w),S();break}if(a&&l||o&&u){var E=L(e[i],"div");switch(M(E,"waiting"),g){case"page-load":W(w.parentNode,x);break;case"seconds-timeout":var k=1e3*parseInt(e[i].getAttribute("pbi-resize-seconds"));t=setTimeout(function(){W(w.parentNode,x)},k);break;case"in-view":N&&!w.src&&H(b)&&W(w.parentNode,x),window.addEventListener("scroll",function(){N&&!w.src&&H(b)&&W(w.parentNode,x)},!1);break;case"click":E.onclick=function(){W(w.parentNode,x)},e[i].firstChild.onclick=function(){W(w.parentNode,x)}}}}m==a&&!a&&l&&y||m==o&&!o&&u&&!y?C(w):(z||A)&&I(e[i].children[0],y,N?a:l,N?o:u,x),N&&(z&&!o&&u||A&&!a&&l)?C(w):!N&&(z&&o&&!u||A&&a&&!l)&&C(w),b&&T(b,h,r,y,v,f,d,p),w&&T(w,h,r,y,v,f,d,p)}};function T(e,t,i,r,n,a,o,s){var d=!1;if(a&&s)var l=r?n:a,c=r?o:s;else l=n,c=o;var p="true"==t.toLowerCase()?36:56;if(i<569&&l===16/9)e.parentNode.style.width="568.88px",e.style.width="568.88px",e.style.height=320+p+"px",d=!0;else if(i<=437&&l===4/3)e.parentNode.style.width="426.66px",e.style.width="426.66px",e.style.height=320+p+"px",d=!0;else if(i<320||i/l<320||c<320&&l!==16/9&&l!==4/3){var u=Math.max(i,320)/l;u<320?(e.parentNode.style.width=320*l+"px",e.style.width=320*l+"px",e.style.height=320+p+"px"):(i<320?(e.parentNode.style.width="320px",e.style.width="320px"):(e.parentNode.style.width=i+"px",e.style.width=i+"px"),e.style.height=u+p+"px"),d=!0}else e.parentNode.style.width="100%",e.style.width="100%",e.style.height=Math.max(e.clientWidth/l,320)+p+"px";d&&console.warn("pbi-resize: requested iframe dimension is below the minimum supported dimensions. Minimum supported width is 320px. Minimum supported height is 376px. Change your Power BI report page size to ensure your content looks great when embedded in your web page or blog.")}function H(e){var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function I(e,t,i,r,n){if(i&&r){var a=e.nextElementSibling;e instanceof HTMLImageElement&&a.src&&n!=a.src&&(a.setAttribute("src",n),M(a.nextElementSibling,"loading"));var o=t?i:r;e.setAttribute("src",o)}}function S(){if(-1!==navigator.userAgent.indexOf("MSIE")||0<navigator.appVersion.indexOf("Trident/")){var e=document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}else window.dispatchEvent(new Event("resize"))}function W(e,t){var i=L(e,"iframe"),r=L(e,"div");L(r,"span").style.display="block";var n=document.createElement("style");n.type="text/css";n.innerHTML="@keyframes pbi-resize-spinner {                0% {                    transform: rotate(0deg);                }                100% {                    transform: rotate(360deg);                }            }",document.getElementsByTagName("head")[0].appendChild(n),i.setAttribute("src",t),i.setAttribute("frameborder","0"),i.setAttribute("allowFullScreen","true"),M(r,"loading")}document.addEventListener("DOMContentLoaded",e),window.addEventListener("resize",e),window.addEventListener("orientationchange",e)}}();</script>
		</textarea>
		<div id="outputContainer" style="display: none; width:70%; margin: auto;">
			<br>
			<h4 class="result-heading">Your Optimized Embed Code</h4>
			<p style="text-align: left;">(copy and paste it into your web page)</p>
			<textarea id="oFrame" style="display: inline-block; height:220px; width: 100%;" onclick="this.select()"></textarea>
			<br>
			<br>
			<br>
			<div class="form-cta-wrapper">
				<button class="form-cta" onclick="showResult();">Show me how it looks</button>
				<br>
				<br>
			</div>
			<br>
			<div id="result"></div>
		</div>
		<br>
		<br>
		<br>
		<br>

		<script type="text/javascript">
			var reportCount = 1;

			function addTextInputListener(inputId, errorMsgIdentifier) {
				document.getElementById(inputId).addEventListener("focus", function () {
					var errorMsg = document.getElementsByClassName(errorMsgIdentifier)[0];
					if(errorMsg && errorMsg.classList.contains("visible")) {
						errorMsg.classList.remove("visible");
					}
				});
			};

			// Desktop input listeners
			addTextInputListener('pbirw-1', 'js-page-width-error-msg-1');
			addTextInputListener('pbirh-1', 'js-page-height-error-msg-1');
			addTextInputListener('cmw-1', 'js-content-min-width-error-msg-1');
			addTextInputListener('img-1', 'js-url-error-msg-1');
			addTextInputListener('url-1', 'js-url-error-msg-1');

			// Mobile input listeners
			addTextInputListener('pbirw-2', 'js-page-width-error-msg-2');
			addTextInputListener('pbirh-2', 'js-page-height-error-msg-2');
			addTextInputListener('sp-2', 'js-sp-error-msg-2');
			addTextInputListener('img-2', 'js-url-error-msg-2');
			addTextInputListener('url-2', 'js-url-error-msg-2');

			function showHideListener(inputClass, dependentId) {
				var elements = document.getElementsByClassName(inputClass);
				var dependentElement = document.getElementById(dependentId);
				for(let i = 0; i < elements.length; i++) {
					if(dependentElement.value) {
						elements[i].style.display = 'table-row';
					}
					else {
						elements[i].style.display = 'none';
					}
				}
			}

			function expandButtonListener(tableId, buttonId) {
				var table = document.getElementById(tableId);
				var button = document.getElementById(buttonId);
				if(table.classList.contains('visible')) {
					table.style.display = 'none';
					table.classList.remove('visible');
					button.innerHTML = '+';
				}
				else {
					table.style.display = 'table';
					table.classList.add('visible');
					button.innerHTML = '-';
				}
			}

			function hanldeMobileWidthChange(e) {
				var switchPoint = document.getElementById('sp-2');
				switchPoint.value = e.value;
			}

			function validateTextField(input, fieldIdentifier, errors) {
				var errorMsg = document.getElementsByClassName(fieldIdentifier)[0];
				if (input === "") {
					errorMsg.classList.add("visible");
					errors = true;
				} else {
					//errorMsg.classList.remove("visible");
				}
				return errors;
			}

			function clearResultSections() {
				var oFrameElement = document.getElementById("oFrame");
				oFrameElement.value = "";

				var result = document.getElementById("result");
				result.innerHTML = "";

				var outputContainerElement = document.getElementById("outputContainer");
				outputContainerElement.style.display = 'none';
			}

			function generateEmbedCode() {
				var errors = false;
				var outputContainerElement = document.getElementById("outputContainer");
				var oFrameElement = document.getElementById("oFrame");
				var template = document.getElementById("tFrame").value;

				clearResultSections();

				//Get inputs
				var webWidth = document.getElementById('pbirw-1').value;
				var webHeight = document.getElementById('pbirh-1').value;
				var webImg = document.getElementById('img-1').value;
				var webSrc = document.getElementById('url-1').value;
				var cmw = document.getElementById('cmw-1').value;
				var cmh = cmw * webWidth / webHeight + 56;
				var loadEvent = document.querySelector('input[name="load-event"]:checked').value;
				var header = document.getElementById('header').checked;
				var btnLeftPos = document.getElementById('btn-pos-left').value;
				var btnTopPos = document.getElementById('btn-pos-top').value;
				var waitingText = document.getElementById('waiting-txt').value;
				var loadingText = document.getElementById('loading-txt').value;
				var readyText = document.getElementById('ready-txt').value;

				var mobileImg = document.getElementById('img-2').value;

				// Do form validation
				errors = validateTextField(webWidth, 'js-page-width-error-msg-1', errors);
				errors = validateTextField(webHeight, 'js-page-height-error-msg-1', errors);
				if(!webImg && !webSrc) {
					errors = validateTextField(webSrc, 'js-url-error-msg-1', errors);
				}

				var mobileSrc = document.getElementById('url-2').value;
				var mobileWidth = document.getElementById('pbirw-2').value;
				var mobileHeight = document.getElementById('pbirh-2').value;
				var switchPoint = document.getElementById('sp-2').value;
				var cmh = switchPoint * mobileWidth / mobileHeight + 56;
				var img = window.innerWidth < switchPoint && mobileImg ? mobileImg : webImg;
				var url = window.innerWidth < switchPoint && mobileSrc ? mobileSrc : webSrc;

				//Do form validation for mobile
				if(document.getElementById('mobile-settings').classList.contains('visible')) {
					errors = validateTextField(switchPoint, 'js-sp-error-msg-2', errors);
				}
				errors = validateTextField(cmw, 'js-content-min-width-error-msg-1', errors);

				//replace placeholders with input variables for output
				if (!errors) {

					var container = document.createElement('div');
					container.setAttribute('pbi-resize', 'powerbi');
					if (webImg) {
						container.setAttribute('pbi-resize-img', webImg);
						var img = document.createElement('img');
					}
					if (webSrc) {
						container.setAttribute('pbi-resize-src', webSrc);
						var iframe = document.createElement('iframe');
					}
					container.setAttribute('pbi-resize-min-width', cmw);
					container.setAttribute('pbi-default-width', '600px');
					container.setAttribute('pbi-default-height', cmh);
					container.setAttribute('pbi-resize-width', webWidth);
					container.setAttribute('pbi-resize-height', webHeight);
					container.setAttribute('pbi-resize-src', webSrc);
					container.setAttribute('pbi-resize-load-event', loadEvent);
					if(loadEvent == "seconds-timeout") {
						container.setAttribute('pbi-resize-seconds', document.getElementById('seconds').value);
					}
					container.setAttribute('pbi-resize-header', header);
					container.style.position = 'relative';

					if(mobileImg || mobileSrc) {
						if(mobileImg) {
							container.setAttribute('pbi-resize-m-img', mobileImg);
							if(!img) {
								var img = document.createElement('img');
							}
						}
						if(mobileSrc) {
							container.setAttribute('pbi-resize-m-src', mobileSrc);
						}
						container.setAttribute('pbi-resize-m-width', mobileWidth);
						container.setAttribute('pbi-resize-m-height', mobileHeight);
						container.setAttribute('pbi-resize-min-width', switchPoint);
					}

					if (img) {
						container.appendChild(img);
					}
					if (iframe) {
						iframe.setAttribute('frameborder', 0);
						iframe.setAttribute('allowFullScreen', true);
						container.appendChild(iframe);
					}
					if(img && iframe) {
						var button = document.createElement('div');
						img.setAttribute('onmouseover', "style.opacity = .9");
						img.setAttribute('onmouseout', "style.opacity = 1");
						img.style.cursor = 'pointer';
						button.style.display = 'flex';
						button.style.justifyContent = 'space-between';
						button.style.lineHeight = '32px';
						button.style.backgroundColor = 'transparent';
						button.style.position = 'absolute';
						button.style.left = btnLeftPos + '%';
						button.style.top = btnTopPos + '%';
						button.style.marginLeft = 'auto';
						button.style.marginRight = 'auto';
						button.style.color = 'black';
						button.style.padding = '10px';
						button.style.cursor = 'pointer';
						button.style.border = 'rgb(50, 50, 50, 1) 2px solid';
						button.setAttribute('pbi-resize-wait-txt', waitingText);
						button.setAttribute('pbi-resize-load-txt', loadingText);
						button.setAttribute('pbi-resize-rdy-txt', readyText);
						button.setAttribute('onmouseover', "style.backgroundColor = 'rgb(200, 200, 200)'");
						button.setAttribute('onmouseout', "style.backgroundColor = 'transparent'");
						var spinner = document.createElement('span');
						spinner.classList.add('pbi-resize-spinner');
						spinner.style.display = 'none';
						spinner.style.width = '25px';
						spinner.style.height = '25px';
						spinner.style.margin = '1px';
						spinner.style.marginLeft = '8px';
						spinner.style.borderRadius = '50%';
						spinner.style.border = '2px solid #000';
						spinner.style.borderColor = '#000 transparent #000 transparent';
						spinner.style.animation = 'pbi-resize-spinner 1.2s linear infinite';

						button.appendChild(spinner);
						container.appendChild(button);
					}

					var output = container.outerHTML;
					oFrameElement.value = output += template;
					outputContainerElement.style.display = '';
				}
			};

			function removeExcessForms(formsRemaining) {
                var form = document.getElementsByClassName("js-mobile-report-form")[0];
                if (form.classList.contains("visible")) {
                    var mobileReportToggle = document.getElementById("mobile-report-toggle");
                    mobileReportToggle.innerText = 'Remove Mobile Report';
                    reportCount--;
                }
			}

			function insertExampleReport(size, example) {
				var sn = "https://app.powerbi.com/view?r=eyJrIjoiZDZlYmM1ZTQtYTBkZi00OGYzLThiNmUtMDU5Nzc0NDVjNTIyIiwidCI6IjNkODE4OGM4LTc3NTgtNDYzYy1iYjNmLTBlMTYwZGUzMzYwZiIsImMiOjN9";
				var ft = "https://app.powerbi.com/view?r=eyJrIjoiNmVmZjNhNDAtYjMxOC00YjZjLWJjNDQtMTViZjM5MDZhNmVhIiwidCI6Ijk0MjYwZjAzLTA3OTMtNDg0YS05MWNmLWJlYmU1ODQzMTliYyIsImMiOjEwfQ%3D%3D";
				var msn = "https://app.powerbi.com/view?r=eyJrIjoiZmUxMjlmNmYtYjY4NC00YWE1LTkyZmMtMmI2ZjVjZGI1NTYyIiwidCI6Ijk0MjYwZjAzLTA3OTMtNDg0YS05MWNmLWJlYmU1ODQzMTliYyIsImMiOjEwfQ%3D%3D";
				var mft = "https://app.powerbi.com/view?r=eyJrIjoiODc4ZjNjNzItZDE5ZC00NTkxLWEwNTEtNzc5OTI3ZTA4NWUxIiwidCI6IjcyZjk4OGJmLTg2ZjEtNDFhZi05MWFiLTJkN2NkMDExZGI0NyIsImMiOjV9";

				removeExcessForms(1);

				if(size == 'web') {
					switch (example) {
					case "e169":
						writeExample('url-1', size, "600", "16:9", 16, 9, sn, false);
						break;
					case "e43":
						writeExample('url-1', size, "600", "4:3", 4, 3, ft, true);
						break;
					}
				}
				else {
					switch (example) {
					case "e169":
						writeExample('url-2', size, null, "9:16", 9, 16, msn);
						break;
					case "e43":
						writeExample('url-2', size, null, "3:4", 3, 4, mft);
						break;
					}
				}
			}

			function insertExampleImage(size, example) {
				var sn = window.location + "16x9.png";
				var ft = window.location + "4x3.png";
				var ns = window.location + "9x16.png";
				var tf = window.location + "3x4.png";

				removeExcessForms(1);

				if(size == 'web') {
					let elements = document.getElementsByClassName('button-customization');
					for(let i = 0; i < elements.length; i++) {
						elements[i].style.display = 'table-row';
					}
					switch (example) {
					case "e169":
						writeExample('img-1', size, "600", "16:9", 16, 9, sn);
						break;
					case "e43":
						writeExample('img-1', size, "600", "4:3", 4, 3, ft);
						break;
					}
				}
				else {
					switch (example) {
					case "e169":
						writeExample('img-2', size, null, "16:9", 9, 16, ns);
						break;
					case "e43":
						writeExample('img-2', size, null, "4:3", 3, 4, tf);
						break;
					}
				}
			}

			function writeExample(id, size, contentMinimumWidth, pageSizeRatio, pageWidth, pageHeight, url, modernheaders) {
				document.getElementById("outputContainer").style.display = 'none';

				var editState = true;
				if (pageSizeRatio === "Custom") {
					editState = false;
				}

				document.getElementById("header").checked = modernheaders;

				if(size == 'web'){
					var pbirw = document.getElementById("pbirw-1");
					pbirw.value = pageWidth;

					var pbirh = document.getElementById("pbirh-1");
					pbirh.value = pageHeight;

					document.getElementById("cmw-1").value = contentMinimumWidth;
					document.getElementById(id).value = url;
				}
				else {
					var pbirw = document.getElementById("pbirw-2");
					pbirw.value = pageWidth;

					var pbirh = document.getElementById("pbirh-2");
					pbirh.value = pageHeight;

					document.getElementById(id).value = url;
				}

				document.getElementById("oFrame").value = "";
			}

			function showResult() {
				document.getElementById("result").innerHTML = document.getElementById("oFrame").value;

				// raise the page resize event so our script runs
				if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {
					// work around for IE
					var evt = document.createEvent('UIEvents');
					evt.initUIEvent('resize', true, false, window, 0);
					window.dispatchEvent(evt);
				} else {
					// other browsers
					window.dispatchEvent(new Event('resize'));
				}
			}

		</script>
		<script>
			function handleLoadEventChange(e) {
				var secs = document.getElementById('seconds-container');
				if(e.value == 'seconds-timeout'){
					secs.classList.add('visible');
					secs.style.display = 'inline-block';
				}
				else {
					secs.classList.remove('visible');
					secs.style.display = 'none';
				}
			}
		</script>
		<script src="script.js"></script>
</body>
</html>
